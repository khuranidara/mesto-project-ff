(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{Wq:()=>H,bj:()=>N,O9:()=>D,ED:()=>M,rC:()=>J});var t=document.querySelector(".popup_type_edit").querySelector(".popup__form"),n=t.querySelector(".button"),r=document.querySelector(".popup_type_new-card").querySelector(".popup__form"),o=r.querySelector(".button"),c=document.querySelector(".popup_type_edit-avatar"),a=c.querySelector(".popup__form"),u=a.querySelector(".button");function i(e,t){e.validity.patternMismatch?e.setCustomValidity("Поле может содержать только латинские и кириллические буквы, знаки дефиса и пробелы."):e.setCustomValidity(""),e.validity.valid?t.textContent="":t.textContent=e.validationMessage}function l(e,t){var n=Array.from(e.querySelectorAll(".popup__input")).some((function(e){return!e.validity.valid}));t.disabled=n}function s(e){var t=e.querySelectorAll(".popup__input"),n=e.querySelectorAll(".error");t.forEach((function(e){e.setCustomValidity("")})),n.forEach((function(e){e.textContent=""}))}t.addEventListener("input",(function(e){t.classList.remove("disable-invalid-styles");var r=e.target;i(r,t.querySelector(".error_".concat(r.name))),l(t,n)})),r.addEventListener("input",(function(e){r.classList.remove("disable-invalid-styles");var t=e.target;i(t,r.querySelector(".error_".concat(t.name))),l(r,o)})),a.addEventListener("input",(function(e){a.classList.remove("disable-invalid-styles");var t=e.target;i(t,a.querySelector(".error_".concat(t.name))),l(a,u)}));var p=document.querySelector(".profile__edit-button"),d=document.querySelector(".profile__add-button"),f=document.querySelector(".popup_type_new-card"),y=document.querySelector(".popup_type_edit"),_=document.querySelectorAll(".popup"),m=document.querySelector(".popup_type_image"),v=m.querySelector(".popup__image"),h=m.querySelector(".popup__caption"),S=document.querySelector(".profile__image"),b=document.querySelector(".popup_type_edit-avatar"),q=b.querySelector(".popup__button");function g(e){"Escape"===e.code&&k(document.querySelector(".popup_is-opened"))}function E(e,t){e.classList.add("popup_is-opened"),document.addEventListener("keydown",g);var n=e.querySelector(".popup__form");if(n){n.classList.add("disable-invalid-styles"),s(n);var r=n.querySelectorAll(".popup__input");"new-place"===n.name&&r.forEach((function(e){e.value=""}));var o=n.querySelector(".button");l(n,o)}}function k(e){e.classList.remove("popup_is-opened"),document.removeEventListener("keydown",g);var t=e.querySelector(".popup__form");if(t){s(t);var n=t.querySelector(".popup__input_type_avatar-link");n&&(n.value="")}}_.forEach((function(e){e.addEventListener("mouseup",(function(t){(t.target.classList.contains("popup__close")||t.target.classList.contains("popup_is-opened"))&&k(e)}))})),p.addEventListener("click",(function(){D.value=J.textContent,N.value=M.textContent,E(y)})),d.addEventListener("click",(function(){E(f)})),S.addEventListener("click",(function(){E(b)}));var C={baseUrl:"https://nomoreparties.co/v1/wff-cohort-2",headers:{authorization:"f607a7d2-acc8-4a4e-8521-3c1435e4561a","Content-Type":"application/json"}},w=document.querySelector('.popup__form[name="new-place"]'),L=w.querySelector(".popup__input_type_card-name"),T=w.querySelector(".popup__input_type_url"),x=document.querySelector(".places__list"),j=document.querySelector("#card-template").content;function A(e,t){(function(e){return fetch("".concat(C.baseUrl,"/cards/").concat(e),{method:"DELETE",headers:C.headers}).then((function(e){if(!e.ok)throw new Error("HTTP ошибка! Статус: ".concat(e.status));return e.json()}))})(t).then((function(){e.target.closest(".card").remove(),console.log("Карточка с ID ".concat(t," удалена успешно."))})).catch((function(e){return console.error("Ошибка при удалении карточки:",e)}))}function P(e,t){!function(e,t){v.src=e,v.alt=t,h.textContent=t,E(m)}(e,t)}function O(e,t,n,r){var o=j.cloneNode(!0),c=o.querySelector(".card__image"),a=o.querySelector(".card__title"),u=o.querySelector(".card__like-button"),i=o.querySelector(".card__delete-button"),l=o.querySelector(".card__like-count");return c.src=e.link,c.alt=e.name,a.textContent=e.name,l.textContent=e.likes?e.likes.length:0,e.owner._id!==H?i.remove():i.addEventListener("click",(function(t){return n(t,e._id)})),c.addEventListener("click",(function(){return r(e.link,e.name)})),u.addEventListener("click",(function(t){return function(e,t,n){t?function(e,t){var n=t?"DELETE":"PUT";return fetch("".concat(C.baseUrl,"/cards/likes/").concat(e),{method:n,headers:C.headers}).then((function(e){if(!e.ok)throw new Error("HTTP ошибка! Статус: ".concat(e.status));return e.json()}))}(t,e.target.classList.contains("card__like-button_is-active")).then((function(t){e.target.classList.toggle("card__like-button_is-active"),n.textContent=t.likes.length})).catch((function(e){return console.error("Ошибка:",e)})):console.error("Ошибка: не указан cardId")}(t,e._id,l)})),o}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var H,I=document.querySelector('.popup__form[name="edit-profile"]'),D=I.querySelector(".popup__input_type_name"),N=I.querySelector(".popup__input_type_description"),J=document.querySelector(".profile__title"),M=document.querySelector(".profile__description"),V=document.querySelector(".profile__image"),G=c.querySelector(".popup__input_type_avatar-link");w.addEventListener("submit",(function(e){e.preventDefault();var t,n,r=L.value,c=T.value;o.textContent="Сохранение...",(t=r,n=c,fetch("".concat(C.baseUrl,"/cards"),{method:"POST",headers:C.headers,body:JSON.stringify({name:t,link:n})}).then((function(e){if(!e.ok)throw new Error("HTTP ошибка! Статус: ".concat(e.status));return e.json()}))).then((function(e){var t=O(e,0,A,P);x.prepend(t),k(f),w.reset()})).catch((function(e){return console.error("Ошибка:",e)})).finally((function(){o.textContent="Сохранить"}))})),I.addEventListener("submit",(function(e){e.preventDefault();var t,r,o=D.value,c=N.value;J.textContent=o,M.textContent=c,n.textContent="Сохранение...",(t=o,r=c,fetch("".concat(C.baseUrl,"/users/me"),{method:"PATCH",headers:C.headers,body:JSON.stringify({name:t,about:r})}).then((function(e){if(!e.ok)throw new Error("HTTP ошибка! Статус: ".concat(e.status));return e.json()}))).then((function(e){V.style.backgroundImage="url(".concat(e.avatar,")"),J.textContent=e.name,M.textContent=e.about,k(y)})).catch((function(e){return console.error("Ошибка:",e)})).finally((function(){n.textContent="Сохранить"}))})),c.addEventListener("submit",(function(e){e.preventDefault();var t,n=G.value;q.textContent="Сохранение...",(t=n,fetch("".concat(C.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:C.headers,body:JSON.stringify({avatar:t})}).then((function(e){if(!e.ok)throw new Error("HTTP ошибка! Статус: ".concat(e.status));return e.json()}))).then((function(e){V.style.backgroundImage="url(".concat(e.avatar,")"),k(c)})).catch((function(e){return console.error("Ошибка:",e)})).finally((function(){q.textContent="Сохранить"}))}));var z=fetch("".concat(C.baseUrl,"/users/me"),{method:"GET",headers:C.headers}).then((function(e){if(!e.ok)throw new Error("HTTP ошибка! Статус: ".concat(e.status));return e.json()})),W=fetch("".concat(C.baseUrl,"/cards"),{method:"GET",headers:C.headers}).then((function(e){if(!e.ok)throw new Error("HTTP ошибка! Статус: ".concat(e.status));return e.json()}));Promise.all([z,W]).then((function(e){var t,n,r=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,c,a,u=[],i=!0,l=!1;try{if(c=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;i=!1}else for(;!(i=(r=c.call(n)).done)&&(u.push(r.value),u.length!==t);i=!0);}catch(e){l=!0,o=e}finally{try{if(!i&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return u}}(t,n)||function(e,t){if(e){if("string"==typeof e)return U(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?U(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],c=r[1];console.log(o),console.log(c),H=o._id,c.forEach((function(e){console.log(e._id)})),console.log(H),J.textContent=o.name,M.textContent=o.about,V.style.backgroundImage="url(".concat(o.avatar,")"),c.forEach((function(e){var t=O(e,0,A,P);x.append(t)}))})).catch((function(e){return console.error("Ошибка:",e)}))})();